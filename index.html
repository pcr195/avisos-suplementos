<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Alarmas suplementos</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 10px; }
    label { display:block; margin-top:8px; }
    input, button { width: 100%; padding: 6px; margin-top:4px; }
    .item { border:1px solid #ccc; padding:6px; margin-top:6px; font-size:14px; }
    .momento-group { margin-top:4px; }
    .momento-group label { display:inline-block; margin-right:10px; }
  </style>
</head>
<body>
  <h2>Mis suplementos</h2>

  <label>Nombre del suplemento</label>
  <input type="text" id="nombre" placeholder="Ej: Magnesio 400 mg">

  <label>Momentos del día</label>
  <div class="momento-group">
    <label><input type="checkbox" id="desayuno"> Desayuno</label>
    <label><input type="checkbox" id="comida"> Comida</label>
    <label><input type="checkbox" id="cena"> Cena</label>
  </div>

  <label>Veces al día</label>
  <input type="number" id="veces" min="1" max="3" value="1">

  <label>Hora base (24h)</label>
  <input type="time" id="hora">

  <button id="btnGuardar" onclick="agregarSuplemento()">Guardar suplemento</button>

  <h3>Lista programada</h3>
  <div id="lista"></div>

  <script>
    let suplementos = JSON.parse(localStorage.getItem('suplementos') || '[]');
    mostrarLista();

    function agregarSuplemento() {
      const nombre = document.getElementById('nombre').value.trim();
      const desayuno = document.getElementById('desayuno').checked;
      const comida   = document.getElementById('comida').checked;
      const cena     = document.getElementById('cena').checked;
      const veces    = parseInt(document.getElementById('veces').value, 10);
      const hora     = document.getElementById('hora').value;

      const momentos = [];
      if (desayuno) momentos.push('Desayuno');
      if (comida)   momentos.push('Comida');
      if (cena)     momentos.push('Cena');

      if (!nombre  !hora  !veces || momentos.length === 0) {
        alert('Rellena nombre, selecciona al menos un momento, indica veces y hora.');
        return;
      }

      suplementos.push({ nombre, momentos, veces, hora });
      localStorage.setItem('suplementos', JSON.stringify(suplementos));
      mostrarLista();

      // Limpiar formulario
      document.getElementById('nombre').value = '';
      document.getElementById('desayuno').checked = false;
      document.getElementById('comida').checked = false;
      document.getElementById('cena').checked = false;
      document.getElementById('veces').value = '1';
      document.getElementById('hora').value = '';
    }

    function borrarSuplemento(i) {
      suplementos.splice(i, 1);
      localStorage.setItem('suplementos', JSON.stringify(suplementos));
      mostrarLista();
    }

    function mostrarLista() {
      const cont = document.getElementById('lista');
      cont.innerHTML = '';
      suplementos.forEach((s, i) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML =
          '<b>' + s.nombre + '</b><br>' +
          'Momentos: ' + s.momentos.join(', ') + '<br>' +
          'Veces al día: ' + s.veces + '<br>' +
          'Hora base: ' + s.hora +
          '<br><button onclick="borrarSuplemento(' + i + ')">Eliminar</button>';
        cont.appendChild(div);
      });
    }

    // Comprobar cada minuto si coincide la hora
    setInterval(() => {
      const ahora = new Date();
      const hh = String(ahora.getHours()).padStart(2, '0');
      const mm = String(ahora.getMinutes()).padStart(2, '0');
      const horaActual = hh + ':' + mm;

      suplementos.forEach(s => {
        if (s.hora === horaActual) {
          alert(
            'Es hora de tomar: ' + s.nombre +
            ' (' + s.momentos.join(', ') +
            ', ' + s.veces + ' vez/veces al día)'
          );
        }
      });
    }, 60000);
  </script>
</body>
</html>
